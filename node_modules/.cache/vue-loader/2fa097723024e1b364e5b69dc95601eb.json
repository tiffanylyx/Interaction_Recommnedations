{"remainingRequest":"/Users/apple/Desktop/study/大四上/Vis/vue_practice/hello-world/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/apple/Desktop/study/大四上/Vis/vue_practice/hello-world/src/components/Map.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/apple/Desktop/study/大四上/Vis/vue_practice/hello-world/src/components/Map.vue","mtime":1610525060687},{"path":"/Users/apple/Desktop/study/大四上/Vis/vue_practice/hello-world/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/study/大四上/Vis/vue_practice/hello-world/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/apple/Desktop/study/大四上/Vis/vue_practice/hello-world/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/apple/Desktop/study/大四上/Vis/vue_practice/hello-world/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/apple/Desktop/study/大四上/Vis/vue_practice/hello-world/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5zZWxlY3RlZF9maXJzdCB7CiAgc3Ryb2tlOiBibGFjazsKICBzdHJva2Utd2lkdGg6IDFweDsKfQouc2VsZWN0ZWRfc2Vjb25kIHsKICBvcGFjaXR5OiAxOwogIHN0cm9rZTogYmxhY2s7CiAgc3Ryb2tlLXdpZHRoOiAxcHg7CiAgZmlsbDogI0JDOEY4RjsKfQouc3VidW5pdC5TQ1QgeyBmaWxsOiAjZGRjOyB9Ci5zdWJ1bml0LldMUyB7IGZpbGw6ICNjZGQ7IH0KLnN1YnVuaXQuTklSIHsgZmlsbDogI2NkYzsgfQouc3VidW5pdC5FTkcgeyBmaWxsOiAjZGNkOyB9Cgouc3VidW5pdC5JUkwsCi5zdWJ1bml0LWxhYmVsLklSTCB7CiAgZGlzcGxheTogbm9uZTsKfQoKLnN1YnVuaXQtYm91bmRhcnkgewogIGZpbGw6IG5vbmU7CiAgc3Ryb2tlOiAjNzc3OwogIHN0cm9rZS1kYXNoYXJyYXk6IDIsMjsKICBzdHJva2UtbGluZWpvaW46IHJvdW5kOwp9Cgouc3VidW5pdC1ib3VuZGFyeS5JUkwgewogIHN0cm9rZTogI2FhYTsKfQoKLnN1YnVuaXQtbGFiZWwgewogIGZpbGw6ICM3Nzc7CiAgZmlsbC1vcGFjaXR5OiAuNTsKICBmb250LXNpemU6IDIwcHg7CiAgZm9udC13ZWlnaHQ6IDMwMDsKICB0ZXh0LWFuY2hvcjogbWlkZGxlOwp9Ci5wbGFjZS1wb2ludAoucGxhY2UKLnBsYWNlLWxhYmVsIHsKICBmaWxsOiAjNDQ0Owp9Cgp0ZXh0IHsKICBmb250LWZhbWlseTogIkhlbHZldGljYSBOZXVlIiwgSGVsdmV0aWNhLCBBcmlhbCwgc2Fucy1zZXJpZjsKICBmb250LXNpemU6IDEwcHg7CiAgcG9pbnRlci1ldmVudHM6IG5vbmU7Cn0KI2xhYmVsIHsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgbGVmdDogMTBweDsKICBmb250LXdlaWdodDogMTAwOwogIGZvbnQtZmFtaWx5OiAiUHJveGltYSBOb3ZhIiwgIk1vbnRzZXJyYXQiLCBzYW5zLXNlcmlmOwp9CgouaG92ZXIgewogICAgZmlsbDogeWVsbG93OyAgIAp9Ci8qCiNzbGlkZXJDb250YWluZXIgewogICAgdGV4dC1hbGlnbjogY2VudGVyOwogICAgdG9wOiA2MDBweDsKICAgIGxlZnQ6MTBweDsKfQojaGlzdHBsb3R7CiAgICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgICB0b3A6IDYwMHB4OwogICAgbGVmdDoxMHB4Owp9CiNtYXAgewogICAgdG9wOiAyMDAwcHg7CiAgICBsZWZ0OjEwMDBweDsKfQoqLwo="},{"version":3,"sources":["Map.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Map.vue","sourceRoot":"src/components","sourcesContent":["/* eslint-disable */\n<template>\n  <div id=\"map\">\n    <p>\n      <h4>Footprint of Sushi</h4>\n  </div>\n</template>\n\n<script>\nimport * as d3 from \"d3\";\nimport * as topojson from \"topojson\"\n//import Vue from 'vue';\nimport Bus from '../assets/bus.js';\n//var msgCenter = new Vue()\nexport default {\n  name: \"App\",\n  data() {\n    return {\n      select_data:'',\n      Hist_select_data:'',\n      myCircle:'',\n      myLink:'',\n      svg:''\n    };\n  },\n  //created() {\n    // 在需要的传递数据的时候调用sendData方法，这里模拟调用\n    //this.sendData();\n  //},\n  mounted() {\n    this.generateArc();\n    this.handle()\n    //this.sendData();\n  },\n  methods: {\n    handle: function () {\n    Bus.$emit(\"Map_age\", this.select_value),\n    Bus.$on(\"Hist_select_data\", (val) => {\n      this.Hist_select_data=val;\n      this.select_new_point()})},\n\n    generateArc() {\n      const width = 700;\n      const height = 640;\n\n      const projection = d3.geoAlbers()\n          .center([0, 28])\n          .rotate([-110, 0])\n          .parallels([20, 60])\n          .translate([width / 2, height / 2])\n          .scale(1550)\n\n\n      const path = d3.geoPath()\n          .projection(projection)\n          .pointRadius(2);\n      const svg = d3\n        .select(\"#map\")\n        .append(\"svg\")\n        .attr(\"width\", width)\n        .attr(\"height\", height);\n      let self = this\n      d3.json(\"sushi_map.json\", function(error, point) {\n      var subunits = topojson.feature(point, point.objects.china),\n      places = topojson.feature(point, point.objects.places);\n\n  svg.selectAll(\".subunit\")\n      .data(subunits.features)\n    .enter().append(\"path\")\n      .attr(\"class\", function(d) { return \"subunit \" + d.id; })\n      .attr(\"d\", path)\n      .attr('stroke','#222')\n      .attr('stroke-width','1px')\n      .attr('fill','#ddd');\n\n// \nvar link1s = [\n  {type: \"LineString\", age:0,coordinates: [[0,0],[0,0]]}\n]\n    for(var i=0, len=places.features.length-1; i<len; i++){\n    // (note: loop until length - 1 since we're getting the next\n    //  item with i+1)\n        link1s.push({\n            type: \"LineString\",\n            age : places.features[i].properties.age,\n            coordinates: [\n                [ places.features[i].geometry.coordinates[0], places.features[i].geometry.coordinates[1]],\n                [ places.features[i+1].geometry.coordinates[0], places.features[i+1].geometry.coordinates[1]]]\n        });\n    }\n    svg.append('svg:defs').append('svg:marker')\n        .attr('id', 'end-arrow')\n        .attr('viewBox', '0 -5 8 8')\n        .attr('refX', 8)\n        .attr('markerWidth', 3)//箭头参数适当按需调整\n        .attr('markerHeight', 3)\n        .attr('orient', 'auto')\n        .append('svg:path')\n        .attr('d', 'M0,-5L10,0L0,5')//绘制箭头形状\n        .attr('fill', '#483D8B');\n  // 加label\n  self.myCircle = svg.selectAll(\".place-point\")\n      .data(places.features)\n    .enter()\n    .append(\"circle\")\n      .attr(\"class\", \"place-point\")\n      .attr(\"transform\", function(d) { return \"translate(\" + projection(d.geometry.coordinates) + \")\"; })\n      .attr(\"x\", function(d) { return d.geometry.coordinates[0] > -1 ? 6 : -6; })\n      .attr(\"dy\", \".35em\")\n      .attr(\"r\", function(d) { return d.properties.age/8; })\n      .attr(\"fill\", \"#6495ED\")\n      .attr(\"opacity\",0.7)\n  self.myLink = svg.selectAll(\"myPath\")\n      .data(link1s)\n      .enter()\n      .append(\"path\")\n        .attr(\"d\", function(d){ return path(d)})\n        .style(\"fill\", \"none\")\n        .style(\"stroke\", \"#483D8B\")\n        .style(\"stroke-width\", 1.6)\n        .style(\"opacity\",0.5)\n        .attr(\"marker-end\", \"url(#end-arrow)\")\n  self.svg = svg\n  /*\n  svg\n    .call( d3.brush()                 // Add the brush feature using the d3.brush function\n      .extent( [ [0,0], [width,height] ] ) // initialise the brush area: start at 0,0 and finishes at width,height: it means I select the whole graph area\n      .on(\"end\", updata_chart)\n    )\n    */\nvar allGroup = ['none',\"select area\", \"zoom1\", \"show point info\"]\nvar dropdownButton = d3.select(\"#map\")\n  .append('select')\n  .on(\"change\", dropchange)\n\n// add the options to the button\ndropdownButton // Add a button\n  .selectAll('myOptions') // Next 4 lines add 6 options = 6 colors\n  .data(allGroup)\n  .enter()\n  .append('option')\n  .text(function (d) { return d; }) // text showed in the menu\n  .attr(\"value\", function (d) { return d; }) \nvar tooltip = d3.select(\"body\")\n    .append(\"div\")\n    .style(\"position\", \"absolute\")\n    .style(\"z-index\", \"10\")\n    .style(\"visibility\", \"hidden\")\n/*\nvar zoom = d3.zoom()\n    .scaleExtent([1, 40])\n    .translateExtent([[0,0], [width, height]])\n    .extent([[0, 0], [width, height]])\n    .on(\"zoom\", zoomed);\nfunction zoomed() {\n    const transform = d3.event.transform; //识别鼠标事件\n    group.attr(\"transform\", transform); //将缩放结果传给g\n    var k = Math.sqrt(100 / projection.scale()); //修改地图尺寸\n    group.attr(\"stroke-width\", 1 / transform.k); //修改对应的属性\n}*/\nfunction dropchange(){\n  var newCereal = d3.select(this).property('value')\n  if (newCereal=='select area'){\n    console.log(newCereal)\n  svg\n    .call( d3.brush()                 // Add the brush feature using the d3.brush function\n      .extent( [ [0,0], [width,height] ] ) // initialise the brush area: start at 0,0 and finishes at width,height: it means I select the whole graph area\n      .on(\"end\", updata_chart)\n    )    \n  }\n  else if ((newCereal=='show point info'))\n    {console.log(newCereal)\n      self.myCircle.on(\"mouseover\", function(d){return tooltip.style(\"visibility\", \"visible\").text(d.properties.name+','+d.properties.age+'岁'),\n      d3.select(this).attr(\"fill\",\"#BC8F8F\");})\n    .on(\"mousemove\", function(d){return tooltip.style(\"top\",\n    (d3.event.pageY-10)+\"px\").style(\"left\",(d3.event.pageX+10)+\"px\").text(d.properties.name+','+d.properties.age+'岁');})\n    .on(\"mouseout\", function(){return tooltip.style(\"visibility\", \"hidden\"),d3.select(this).transition().duration(500).attr(\"fill\",\"#483D8B\");})\n    }\n    /*\n  else if ((newCereal='zoom1')) {\nself.svg.call(zoom)\n  }*/\n}\n\n  function updata_chart(){\n    var select_data = update_data()\n  Bus.$emit(\"Map_select_data\", select_data)\n  }\n\n  function update_data() {\n    var select_data = []\n    var extent = d3.event.selection\n    self.myCircle.classed(\"selected_first\", function(d){ return isBrushed(extent, projection(d.geometry.coordinates)[0],projection(d.geometry.coordinates)[1]) } )\n\n    for(i=0, len=places.features.length-1; i<len; i++){\n      var d = places.features[i]\n      if(isBrushed(extent, projection(d.geometry.coordinates)[0],projection(d.geometry.coordinates)[1]))\n        {//a = a+parseInt(d.properties.age)}\n        select_data.push(d)}\n      }\n      return select_data\n      }\n/*\nfunction unique(arr) {\n    return arr.filter(function(item, index, arr) {\n      // 取出元素, 该元素在数组中第一次出现的索引 === 当前索引值\n      return arr.indexOf(item, 0) === index;\n    })}   \n*/  \nfunction isBrushed(brush_coords, cx, cy) {\n       var x0 = brush_coords[0][0],\n           x1 = brush_coords[1][0],\n           y0 = brush_coords[0][1],\n           y1 = brush_coords[1][1];\n      return x0 <= cx && cx <= x1 && y0 <= cy && cy <= y1;    // This return TRUE or FALSE depending on if the points is in the selected area\n  }\n\n  })},\n  \n  select_new_point(){\n    var data = this.Hist_select_data\n    this.myCircle.classed(\"selected_second\", function(d){return isSelectedByHist(d)})\n    //this.myLink.style(\"stroke\",function(d) {return LinkisSelectedByHist(d)})\n    //this.myLink.style(\"opacity\",function(d) {return LinkisSelectedByHist_O(d)})\n    //this.myLink.style(\"stroke-width\",function(d) {return LinkisSelectedByHist_S(d)})\n    \nfunction isSelectedByHist(a){\n  for(var i=0,len=data.length;i<len;i++){\n    var geo = data[i].geometry.coordinates\n    var age_select = data[i].properties.age\n    if (a.geometry.coordinates==geo){\n      if(a.properties.age==age_select){\n        return (1==1)\n      }}}\n  return (1==0)}\n/*\nfunction LinkisSelectedByHist(a){\nfor(var i=0,len=data.length;i<len;i++){\n    var geo = data[i].geometry.coordinates\n    var age_select = data[i].properties.age\n    if(a.age==age_select){\n      if (a.coordinates[0][0]==geo[0]){\n        if (a.coordinates[0][1]==geo[1]){\n          console.log('in184')\n          return \"orange\"}}}\n    else return \"blue\"\n\n}}\nfunction LinkisSelectedByHist_O(a){\nfor(var i=0,len=data.length;i<len;i++){\n    var geo = data[i].geometry.coordinates\n    var age_select = data[i].properties.age\n    if(a.age==age_select){\n      if (a.coordinates[0][0]==geo[0]){\n        if (a.coordinates[0][1]==geo[1]){\n          console.log('in196')\n          return 1}}}\n    else return 0.2\n\n}}\nfunction LinkisSelectedByHist_S(d){\nfor(var i=0,len=data.length;i<len;i++){\n    var geo = data[i].geometry.coordinates\n    var age_select = data[i].properties.age\n    if(d.age==age_select){\n      if (d.coordinates[0][0]==geo[0]){\n        if (d.coordinates[0][1]==geo[1]){\n          console.log('in208')\n          return 3}}}\n    else return 2\n\n}}\n*/}}\n};\n</script>\n<style>\n\n.selected_first {\n  stroke: black;\n  stroke-width: 1px;\n}\n.selected_second {\n  opacity: 1;\n  stroke: black;\n  stroke-width: 1px;\n  fill: #BC8F8F;\n}\n.subunit.SCT { fill: #ddc; }\n.subunit.WLS { fill: #cdd; }\n.subunit.NIR { fill: #cdc; }\n.subunit.ENG { fill: #dcd; }\n\n.subunit.IRL,\n.subunit-label.IRL {\n  display: none;\n}\n\n.subunit-boundary {\n  fill: none;\n  stroke: #777;\n  stroke-dasharray: 2,2;\n  stroke-linejoin: round;\n}\n\n.subunit-boundary.IRL {\n  stroke: #aaa;\n}\n\n.subunit-label {\n  fill: #777;\n  fill-opacity: .5;\n  font-size: 20px;\n  font-weight: 300;\n  text-anchor: middle;\n}\n.place-point\n.place\n.place-label {\n  fill: #444;\n}\n\ntext {\n  font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;\n  font-size: 10px;\n  pointer-events: none;\n}\n#label {\n  position: absolute;\n  left: 10px;\n  font-weight: 100;\n  font-family: \"Proxima Nova\", \"Montserrat\", sans-serif;\n}\n\n.hover {\n    fill: yellow;   \n}\n/*\n#sliderContainer {\n    text-align: center;\n    top: 600px;\n    left:10px;\n}\n#histplot{\n    text-align: center;\n    top: 600px;\n    left:10px;\n}\n#map {\n    top: 2000px;\n    left:1000px;\n}\n*/\n</style>"]}]}